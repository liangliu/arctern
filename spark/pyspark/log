+--------+--------------------+---------------------+---------------+-------------+----------------+---------------+-----------------+----------------+-----------+----------+------------+
|VendorID|tpep_pickup_datetime|tpep_dropoff_datetime|passenger_count|trip_distance|pickup_longitude|pickup_latitude|dropoff_longitude|dropoff_latitude|fare_amount|tip_amount|total_amount|
+--------+--------------------+---------------------+---------------+-------------+----------------+---------------+-----------------+----------------+-----------+----------+------------+
|CMT     |null                |null                 |1              |1.4          |-73.993003      |40.747594      |-73.983609       |40.760426       |5.8        |0.0       |5.8         |
|VTS     |null                |null                 |1              |2.14         |-73.959908      |40.776353      |-73.98348        |40.759042       |10.1       |2.0       |12.1        |
|CMT     |null                |null                 |1              |2.7          |-73.955183      |40.773459      |-73.985134       |40.759251       |10.1       |1.0       |11.1        |
|CMT     |null                |null                 |1              |1.3          |-73.985233      |40.744682      |-73.983244       |40.758766       |5.7        |0.0       |5.7         |
|CMT     |null                |null                 |1              |8.2          |-73.997969      |40.682816      |-73.983289       |40.758236       |21.7       |0.0       |21.7        |
|VTS     |null                |null                 |5              |2.76         |-73.996458      |40.758197      |-73.987072       |40.759525       |10.1       |0.0       |10.6        |
|VTS     |null                |null                 |3              |0.76         |-73.98824       |40.74896       |-73.981068       |40.759423       |4.5        |0.0       |5.5         |
|VTS     |null                |null                 |1              |1.99         |-73.985185      |40.735828      |-73.98158        |40.759552       |7.7        |0.0       |7.7         |
|CMT     |null                |null                 |1              |0.9          |-73.989726      |40.767795      |-73.982844       |40.759284       |7.3        |0.0       |7.3         |
|CMT     |null                |null                 |1              |1.3          |-73.992669      |40.768327      |-73.982507       |40.758157       |8.1        |0.0       |8.1         |
|VTS     |null                |null                 |4              |2.24         |-74.00106       |40.731502      |-73.982103       |40.758365       |8.1        |0.0       |8.1         |
|CMT     |null                |null                 |2              |1.4          |-73.97806       |40.746023      |-73.983035       |40.760364       |6.1        |0.0       |6.1         |
|VTS     |null                |null                 |5              |2.38         |-73.993892      |40.73201       |-73.981717       |40.760253       |10.1       |2.0       |13.1        |
|VTS     |null                |null                 |5              |1.6          |-73.989523      |40.77129       |-73.981863       |40.758422       |7.3        |2.0       |9.3         |
|VTS     |null                |null                 |5              |0.96         |-73.973462      |40.751995      |-73.983285       |40.760113       |5.3        |1.0       |6.3         |
|CMT     |null                |null                 |1              |1.5          |-73.991766      |40.749814      |-73.984934       |40.760172       |6.5        |0.0       |6.5         |
|CMT     |null                |null                 |1              |0.7          |-73.973169      |40.763804      |-73.98175        |40.758227       |4.1        |0.0       |4.1         |
|VTS     |null                |null                 |1              |2.8          |-74.000783      |40.725987      |-73.986002       |40.759373       |12.5       |0.0       |13.5        |
|CMT     |null                |null                 |1              |0.6          |-73.972966      |40.755932      |-73.982318       |40.760308       |4.1        |0.0       |4.1         |
|VTS     |null                |null                 |1              |4.09         |-74.010162      |40.720618      |-73.981827       |40.76016        |12.1       |0.0       |12.1        |
+--------+--------------------+---------------------+---------------+-------------+----------------+---------------+-----------------+----------------+-----------+----------+------------+
only showing top 20 rows

root
 |-- x: double (nullable = true)
 |-- y: double (nullable = true)
 |-- w: long (nullable = true)

+------------------------------------------+---+
|pickup_point                              |w  |
+------------------------------------------+---+
|POINT (4536001.41513105 -12512719.9906751)|1  |
|POINT (4539202.85236677 -12499373.294406) |1  |
|POINT (4538880.69376042 -12497469.9636295)|1  |
|POINT (4535677.25277386 -12509584.0588693)|1  |
|POINT (4528790.36115644 -12514725.0191682)|1  |
|POINT (4537181.73569193 -12514114.886964) |5  |
|POINT (4536153.47755547 -12510797.4927285)|3  |
|POINT (4534691.63000237 -12509564.6909228)|1  |
|POINT (4538250.18016456 -12511397.2297057)|1  |
|POINT (4538309.40213367 -12512585.1595144)|1  |
|POINT (4534210.0618852 -12515973.3201406) |4  |
|POINT (4535826.53221101 -12506690.3881616)|2  |
|POINT (4534266.61218653 -12513078.8809786)|5  |
|POINT (4538639.24178489 -12511315.2974334)|5  |
|POINT (4536491.33221003 -12504836.1655208)|5  |
|POINT (4536248.54440061 -12512220.6446731)|1  |
|POINT (4537805.90407681 -12504718.0257854)|1  |
|POINT (4533596.13489348 -12515861.4440544)|1  |
|POINT (4536929.59704528 -12504636.1759393)|1  |
|POINT (4532998.46054741 -12519650.529257) |1  |
+------------------------------------------+---+
only showing top 20 rows

+---------------+---+
|point          |w  |
+---------------+---+
|POINT (448 95) |1  |
|POINT (0 1024) |1  |
|POINT (0 1024) |1  |
|POINT (0 1024) |1  |
|POINT (0 1024) |1  |
|POINT (0 1024) |5  |
|POINT (482 751)|3  |
|POINT (0 1024) |1  |
|POINT (0 1024) |1  |
|POINT (0 1024) |1  |
|POINT (0 1024) |4  |
|POINT (0 1024) |2  |
|POINT (0 1024) |5  |
|POINT (0 1024) |5  |
|POINT (0 1024) |5  |
|POINT (503 266)|1  |
|POINT (0 1024) |1  |
|POINT (0 1024) |1  |
|POINT (0 1024) |1  |
|POINT (0 1024) |1  |
+---------------+---+
only showing top 20 rows

{
  "width": 300,
  "height": 200,
  "description": "heat_map_2d",
  "data": [
    {
      "name": "data",
      "url": "/data/data.csv"
    }
  ],
  "scales": [
    {
      "name": "x",
      "type": "linear",
      "domain": {
        "data": "data",
        "field": "c0"
      }
    },
    {
      "name": "y",
      "type": "linear",
      "domain": {
        "data": "data",
        "field": "c1"
      }
    }
  ],
  "marks": [
    {
      "encode": {
        "enter": {
          "map_scale": {
            "value": 10.0
          }
        }
      }
    }
  ]
}
Traceback (most recent call last):
  File "/home/xge/work/GIS/spark/pyspark/examples/nyc_taxi.py", line 115, in <module>
    draw_map(spark_session)
  File "/home/xge/work/GIS/spark/pyspark/examples/nyc_taxi.py", line 100, in draw_map
    save_png(hex_data, '/tmp/heatmap.png')
  File "/home/xge/work/GIS/spark/pyspark/arctern_pyspark/render_func.py", line 10, in save_png
    binary_string = binascii.unhexlify(str(hex_data))
binascii.Error: Non-hexadecimal digit found
